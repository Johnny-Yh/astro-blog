---
title: ğŸ”§JDæ‰‹æœºæ•°æ®çˆ¬è™«
description: çˆ¬å–äº¬ä¸œä¸Šçš„æ‰‹æœºé”€å”®æ•°æ®
author: Johnny
pubDatetime: 2020-06-05T10:26:00Z
featured: false
draft: false
tags:
  - Crawl
---

# ç®€è¿°

è¿™æ˜¯æˆ‘ä¸€é—¨å¤§æ•°æ®ç›¸å…³è¯¾ç¨‹çš„è¯¾ç¨‹é¡¹ç›®ï¼Œé€šè¿‡çˆ¬è™«è·å–äº¬ä¸œä¸Šæ‰‹æœºçš„é”€å”®æ•°æ®ã€‚ç›®å‰æ¶ˆè´¹å¸‚åœºä¸Šçš„æ‰‹æœºå“ç‰Œå¤šç§å¤šæ ·ï¼Œæ¯”è¾ƒå¸¸è§çš„æœ‰ï¼šè‹¹æœï¼Œä¸‰æ˜Ÿï¼Œåä¸ºï¼Œå°ç±³ï¼ŒVIVOï¼ŒOPPOï¼Œä¸€åŠ ï¼Œé­…æ—ï¼ŒåŠªæ¯”äºšï¼Œè”æƒ³ï¼Œé”¤å­ï¼Œè¯ºåŸºäºšï¼Œç´¢å°¼ï¼Œä¸­å…´ï¼Œåç¡•ï¼Œé»‘é²¨ç­‰ï¼Œè®¡åˆ’é€šè¿‡ç®€å•çš„Pythonä»£ç çˆ¬å–äº¬ä¸œä»¥â€œæ‰‹æœºâ€ä¸ºå…³é”®è¯çš„å‰100é¡µå•†å“ï¼ˆæœç´¢ä¸Šé™å°±æ˜¯100é¡µï¼‰çš„å•†å“ä¿¡æ¯ï¼Œä»·æ ¼ï¼Œå•†å®¶ï¼Œè¯„ä»·æ•°ï¼ˆé”€é‡çš„å¦ä¸€ç§ä½“ç°ï¼‰ï¼Œå’Œé“¾æ¥ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—å’Œå¤„ç†ï¼Œæœ€åå­˜å‚¨åˆ°MySQLæ•°æ®åº“ä¸­ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹©äº¬ä¸œä½œä¸ºè°ƒç ”å¹³å°ï¼Ÿ

é€‰æ‹©äº¬ä¸œä½œä¸ºç”µå•†æ•°æ®é‡‡é›†å¹³å°ä¸»è¦åŸºäºä»¥ä¸‹ä¸‰ä¸ªè€ƒè™‘ï¼š

### 1. æŠ€æœ¯å¯è¡Œæ€§é«˜

è™½ç„¶æ·˜å®æ‹¥æœ‰æ›´ä¸°å¯Œçš„å•†å“ç§ç±»ï¼Œä½†å…¶å®Œå¤‡çš„åçˆ¬è™«æœºåˆ¶ä½¿å¾—ç®€å•çˆ¬è™«ç¨‹åºéš¾ä»¥è·å–æœ‰æ•ˆæ•°æ®ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œäº¬ä¸œçš„åçˆ¬è™«é™åˆ¶ç›¸å¯¹å®½æ¾ï¼Œå¯ä»¥æ˜¾è‘—é™ä½å¼€å‘éš¾åº¦ã€‚

### 2. æ•°æ®çœŸå®å¯é 

äº¬ä¸œå¹³å°çš„åˆ·å•ç°è±¡ç›¸å¯¹è¾ƒå°‘ï¼Œè€Œæ·˜å®çš„åˆ·å•æƒ…å†µåˆ™æ¯”è¾ƒæ™®éã€‚é€‰æ‹©äº¬ä¸œå¯ä»¥ç¡®ä¿é‡‡é›†åˆ°çš„æ•°æ®æ›´åŠ çœŸå®å¯é ï¼Œæé«˜åˆ†æç»“æœçš„å‡†ç¡®æ€§ã€‚

### 3. ç”¨æˆ·è´­ä¹°å€¾å‘

å¯¹äºæ‰‹æœºè¿™ç±»é«˜ä»·å€¼ç”µå­äº§å“ï¼š
- äº¬ä¸œè‡ªè¥å•†åŸæä¾›æ›´å¯é çš„å”®åä¿éšœ
- æ¶ˆè´¹è€…æ›´å€¾å‘äºåœ¨äº¬ä¸œç­‰æ­£è§„æ¸ é“è´­ä¹°
- æ•°æ®æ›´èƒ½åæ˜ çœŸå®çš„å¸‚åœºæƒ…å†µ

# çˆ¬è™«åˆ†æ

## ç½‘é¡µé“¾æ¥åˆ†æ

![äº¬ä¸œæœç´¢é¡µé¢](https://assets.beyh.net/20200605-1.avif)

é¦–å…ˆå¯¹äº¬ä¸œçš„ç½‘é¡µé“¾æ¥è¿›è¡Œåˆ†æï¼š

![é“¾æ¥ç»“æ„](https://assets.beyh.net/20200605-5.avif)

ç»è¿‡ç®€åŒ–åï¼Œè¿™ä¸ªé“¾æ¥ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚è®©æˆ‘ä»¬å¯¹é“¾æ¥çš„å…³é”®å‚æ•°è¿›è¡Œåˆ†æï¼š

![å‚æ•°åˆ†æ](https://assets.beyh.net/20200605-3.avif)

### URLå‚æ•°è¯´æ˜

- **Keywordå‚æ•°**ï¼šæœç´¢çš„å…³é”®å­—ï¼Œæœ¬ä¾‹ä¸­ä¸º"æ‰‹æœº"
- **Encå‚æ•°**ï¼šencodingç¼–ç è®¾ç½®ï¼Œé»˜è®¤ä¸ºutf-8ï¼Œè¯¥å‚æ•°ä¸å¯çœç•¥ï¼Œå¦åˆ™ä¼šå‡ºç°ä¹±ç 
- **Pageå‚æ•°**ï¼šå½“å‰æœç´¢é¡µé¢çš„é¡µæ•°ï¼Œéµå¾ªä»¥ä¸‹è§„å¾‹ï¼š
  - ç¬¬äºŒé¡µæ˜¾ç¤ºpage=3
  - æ¯å¢åŠ ä¸€é¡µï¼Œpageå¢åŠ 2
  - é¡µæ•°è®¡ç®—å…¬å¼ï¼šé¡µæ•° = page * 2 - 1

## é¡µé¢å…ƒç´ å®šä½

æ¥ä¸‹æ¥éœ€è¦å®šä½ç½‘é¡µHTMLä»£ç ä¸­çš„å•†å“å…ƒç´ ã€‚é€šè¿‡æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥å‡†ç¡®å®šä½åˆ°å•†å“å…ƒç´ çš„ä½ç½®ï¼š

![å…ƒç´ å®šä½](https://assets.beyh.net/20200605-4.avif)

# æ•°æ®åº“è®¾è®¡

## æ•°æ®å­˜å‚¨æ–¹æ¡ˆ

çˆ¬å–çš„æ•°æ®å°†å­˜å‚¨åœ¨æœ¬åœ°MySQLæ•°æ®åº“ä¸­ã€‚æ•°æ®è¡¨åŒ…å«ä»¥ä¸‹å­—æ®µï¼š

- **åºå·**ï¼šå•†å“çˆ¬å–åºå·ï¼ˆä¸»é”®ï¼‰
- **æ‰‹æœºåç§°**ï¼šäº§å“åç§°
- **ä»·æ ¼**ï¼šå•†å“ä»·æ ¼
- **è¯„ä»·æ•°**ï¼šå•†å“è¯„ä»·æ•°é‡ï¼ˆåæ˜ é”€é‡ï¼‰
- **å•†å®¶**ï¼šé”€å”®å•†å®¶ä¿¡æ¯
- **é“¾æ¥**ï¼šå•†å“è¯¦æƒ…é¡µé“¾æ¥

## å­—æ®µç±»å‹è®¾è®¡

- åºå·ï¼šä¸»é”®ï¼Œè‡ªå¢
- ä»·æ ¼ã€è¯„ä»·æ•°ï¼šä½¿ç”¨INTç±»å‹å­˜å‚¨æ•°å€¼
- å…¶ä»–å­—æ®µï¼šé‡‡ç”¨VARCHARç±»å‹å­˜å‚¨æ–‡æœ¬

## æ•°æ®åº“ç»“æ„ç¤ºæ„å›¾

ä¸‹å›¾å±•ç¤ºäº†æ•°æ®è¡¨çš„å…·ä½“ç»“æ„ï¼š

![æ•°æ®åº“è¡¨ç»“æ„](https://assets.beyh.net/20200605-2.avif)

# ä»£ç å®ç°

æœ¬é¡¹ç›®ä¸»è¦ä½¿ç”¨Pythonçš„Seleniumåº“è¿›è¡Œç½‘é¡µçˆ¬å–ã€‚å®Œæ•´ä»£ç å®ç°å¦‚ä¸‹ï¼š

```python
    from selenium import webdriver
    from selenium.common.exceptions import TimeoutException
    from selenium.webdriver.common.by import By
    from selenium.webdriver.support import expected_conditions as EC
    from selenium.webdriver.support.wait import WebDriverWait
    from multiprocessing.pool import Pool
    from urllib.parse import quote
    from pyquery import PyQuery as pq
    import time
    import pymysql
    import cryptography
    
    a=1
    options = webdriver.ChromeOptions()
    options.add_argument('--headless')
    browser = webdriver.Chrome(chrome_options=options)
    wait = WebDriverWait(browser,10)
    KEYWORD = 'æ‰‹æœº'#æœç´¢çš„å…³é”®å­—æ˜¯æ‰‹æœº
    
    headers = {
        'User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36',
        'x-requested-with':'XMLHttpRequest'#ç”¨äºç¿»é¡µ
    }
    
    def index_page(page):
    
        print('æ­£åœ¨çˆ¬å–ç¬¬', page, 'é¡µ')
        try:
            url = 'https://search.jd.com/Search?keyword={}&enc=utf-8&page={}'.format(quote(KEYWORD),page*2-1)
            print(url)
            browser.get(url)
            time.sleep(0.5)
            return browser.page_source
            # browser.close()
        except TimeoutException:
            index_page(page)
    
    def connect_mysql(sql):#å†™å…¥åˆ°MySQLæ•°æ®åº“
    
        coon = pymysql.connect(host='localhost',port=3306,user='root',passwd ='123456',db ='phone',charset ='utf8')
        cur = coon.cursor()
        cur.execute(sql)
        if sql.strip()[:6].upper() == 'SELECT':
        res = cur.fetchall()
        else:
        coon.commit()
        res = 'ok'
        cur.close()
        coon.close()
    
        return res
    
    def get_products(html):
        global a
        # html = browser.page_source
        doc = pq(html)
        items = doc('#J_goodsList > ul > li').items()#å…¨éƒ¨ä¿¡æ¯éƒ½åœ¨ulä¸‹çš„liä¸­
        
        for item in items:
            product = {
                'ä»·æ ¼': item.find('div > div.p-price > strong > i').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-price > strong > i
                'è¯„ä»·æ•°': item.find('div > div.p-commit > strong > a').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-commit > strong > a
                'å•†å®¶': item.find('div.p-shop > span > a').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-shop > span > a
                'æ‰‹æœºåç§°': item.find('div > div.p-name.p-name-type-2 > a > em').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-name.p-name-type-2 > a > em
                'é“¾æ¥': item.find('div > div.p-img > a').attr('href'),#J_goodsList > ul > li:nth-child(1) > div > div.p-img > a
            }
            price=product['ä»·æ ¼']
            phone=product['æ‰‹æœºåç§°']
            mark=product['è¯„ä»·æ•°']
            seller=product['å•†å®¶']
            link=product['é“¾æ¥']
    
            if price.isdigit():
                continue#å¦‚æœä»·æ ¼ä¸æ˜¯æ•°å­—ï¼Œè·³è¿‡æœ¬æ¬¡å¾ªç¯
            mark=mark.replace('+','')#å•ä½æ ‡å‡†åŒ–
            if 'ä¸‡' in mark:
                mark=mark.replace('ä¸‡','')#å•ä½æ ‡å‡†åŒ–
                mark=float(mark)
                mark=mark*10000
            else:
                mark=float(mark)
            
            print(product)
            sql="INSERT INTO `phone`.`phone_list` (`åºå·`,`æ‰‹æœºåç§°`, `ä»·æ ¼`, `è¯„ä»·æ•°(é”€é‡)`, `å•†å®¶`, `é“¾æ¥`) VALUES ('"+str(a)+"', '"+phone+"', '"+price+"','"+str(mark)+"','"+seller+"','"+link+"');"
            connect_mysql(sql)
            a+=1
            
    if __name__ == '__main__':
        for i in range(1,101):#å¾ªç¯100æ¬¡
            get_products(index_page(i))
```

# ç»“æœ

æœ€åä¸€å…±çˆ¬å–åˆ°äº†3000ä¸ªå•†å“ï¼Œå­˜å‚¨åˆ°æ•°æ®åº“åçš„æ•ˆæœå¦‚ä¸‹ï¼š
![](https://assets.beyh.net/20200605-6.avif)
æ•°æ®é‡‡é›†çš„ä»»åŠ¡å®Œæˆã€‚

- è¯·æ³¨æ„ï¼Œæœ¬å·¥ä½œå®Œæˆæ—¶é—´ä¸ºï¼š2019-12-11ï¼Œç›¸åº”çš„æ•°æ®å¯èƒ½ä¸ç°åœ¨ä¸åŒï¼Œéœ€æ³¨æ„æ—¶æ•ˆæ€§ã€‚