---
title: ğŸ”§JDæ‰‹æœºæ•°æ®çˆ¬è™«
description: ä½¿ç”¨Pythonçˆ¬å–äº¬ä¸œä¸Šçš„æ‰‹æœºé”€å”®æ•°æ®
author: Johnny
pubDatetime: 2020-06-05T10:26:00Z
featured: false
draft: false
tags:
  - Crawl
---

# ç®€è¿°

è¿™æ˜¯æˆ‘ä¸€é—¨å¤§æ•°æ®ç›¸å…³è¯¾ç¨‹çš„è¯¾ç¨‹é¡¹ç›®ï¼Œé€šè¿‡çˆ¬è™«è·å–äº¬ä¸œä¸Šæ‰‹æœºçš„é”€å”®æ•°æ®ã€‚ç›®å‰æ¶ˆè´¹å¸‚åœºä¸Šçš„æ‰‹æœºå“ç‰Œå¤šç§å¤šæ ·ï¼Œæ¯”è¾ƒå¸¸è§çš„æœ‰ï¼šè‹¹æœï¼Œä¸‰æ˜Ÿï¼Œåä¸ºï¼Œå°ç±³ï¼ŒVIVOï¼ŒOPPOï¼Œä¸€åŠ ï¼Œé­…æ—ï¼ŒåŠªæ¯”äºšï¼Œè”æƒ³ï¼Œé”¤å­ï¼Œè¯ºåŸºäºšï¼Œç´¢å°¼ï¼Œä¸­å…´ï¼Œåç¡•ï¼Œé»‘é²¨ç­‰ï¼Œè®¡åˆ’é€šè¿‡ç®€å•çš„Pythonä»£ç çˆ¬å–äº¬ä¸œä»¥â€œæ‰‹æœºâ€ä¸ºå…³é”®è¯çš„å‰100é¡µå•†å“ï¼ˆæœç´¢ä¸Šé™å°±æ˜¯100é¡µï¼‰çš„å•†å“ä¿¡æ¯ï¼Œä»·æ ¼ï¼Œå•†å®¶ï¼Œè¯„ä»·æ•°ï¼ˆé”€é‡çš„å¦ä¸€ç§ä½“ç°ï¼‰ï¼Œå’Œé“¾æ¥ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—å’Œå¤„ç†ï¼Œæœ€åå­˜å‚¨åˆ°MySQLæ•°æ®åº“ä¸­ã€‚

Q:ä¸ºä»€ä¹ˆè°ƒæŸ¥çš„ç”µå•†å¹³å°é€‰æ‹©äº¬ä¸œï¼Ÿ
A:
1. ä¸€å¼€å§‹æƒ³é€‰æ‹©æ·˜å®ä½œä¸ºè°ƒæŸ¥çš„å¹³å°ï¼Œå› ä¸ºæ·˜å®çš„å•†å“ç§ç±»æ›´åŠ ä¸°å¯Œã€‚ä½†æ˜¯æ·˜å®æœ‰éå¸¸å®Œå¤‡çš„åçˆ¬è™«æœºåˆ¶ï¼Œç®€å•çš„çˆ¬è™«ç¨‹åºå¾ˆéš¾çˆ¬å–åˆ°æœ‰æ•ˆçš„æ•°æ®ï¼Œè€Œäº¬ä¸œå¯¹äºçˆ¬è™«æ²¡æœ‰å¾ˆä¸¥æ ¼çš„é™åˆ¶ï¼Œé€‰æ‹©äº¬ä¸œä½œä¸ºè°ƒæŸ¥çš„ç”µå•†å¹³å°å¯ä»¥å‡å°‘ä»£ç çš„å·¥ä½œé‡ã€‚

2. æ·˜å®çš„åˆ·å•ç°è±¡è¾ƒä¸ºä¸¥é‡ï¼Œè€Œäº¬ä¸œçš„åˆ·å•ç°è±¡åˆ™ä¸æ˜¯å¾ˆæ™®éï¼Œé€‰æ‹©äº¬ä¸œä½œä¸ºè°ƒæŸ¥çš„ç”µå•†å¹³å°å¯ä»¥è®©è·å–çš„æ•°æ®æ›´åŠ çœŸå®ã€‚

3. äº¬ä¸œçš„å”®åä½“ç³»ï¼Œç‰¹åˆ«æ˜¯äº¬ä¸œè‡ªè¥çš„å•†åº—ï¼Œåœ¨å”®åæ–¹é¢æ›´åŠ æœ‰ä¿éšœï¼Œè€Œæ™ºèƒ½æ‰‹æœºå±äºè´µé‡ç‰©å“ï¼Œç›¸æ¯”äºæ·˜å®ï¼Œæ›´å¤šäººå€¾å‘åœ¨äº¬ä¸œè´­ä¹°æ‰‹æœºã€‚

# çˆ¬è™«åˆ†æ

![](https://assets.beyh.net/20200605-1.avif)
é¦–å…ˆå¯¹äº¬ä¸œçš„ç½‘é¡µé“¾æ¥è¿›è¡Œåˆ†æï¼š
![](https://assets.beyh.net/20200605-2.avif)
ç»è¿‡ç®€åŒ–åï¼Œè¿™ä¸ªé“¾æ¥ä¹Ÿå¯ä»¥æ­£å¸¸ä½¿ç”¨ï¼Œç„¶åå¯¹é“¾æ¥çš„å…³é”®å­—è¿›è¡Œåˆ†æï¼š
![](https://assets.beyh.net/20200605-3.avif)
Keywordå‚æ•°ï¼šå°±æ˜¯æœç´¢çš„å…³é”®å­—ï¼Œè¿™é‡Œæˆ‘ä»¬è¦æœç´¢çš„å…³é”®å­—å°±æ˜¯â€œæ‰‹æœºâ€ã€‚
Encå‚æ•°ï¼šå°±æ˜¯encodingç¼–ç çš„å…³é”®å­—ï¼Œæ˜¯ç½‘é¡µé»˜è®¤çš„utf-8ï¼Œä¸åŠ è¿™ä¸ªå‚æ•°ä¼šå‡ºç°ä¹±ç ã€‚
Pageå‚æ•°ï¼šæ˜¯å½“å‰æœç´¢é¡µé¢çš„é¡µæ•°çš„å…³é”®å­—ï¼Œç¬¬äºŒé¡µæ˜¾ç¤ºpage=3ï¼Œè§„å¾‹å°±æ˜¯æ¯å¢åŠ ä¸€é¡µï¼Œpageä¼šå¢åŠ 2ï¼Œæ‰€ä»¥é¡µæ•°=page*2-1ã€‚
æ¥ä¸‹æ¥å®šä½ç½‘é¡µhtmlä»£ç ä¸­å•†å“å…ƒç´ çš„ä½ç½®ï¼Œé€šè¿‡æµè§ˆå™¨çš„å¼€å‘è€…å·¥å…·å¯ä»¥ç›´æ¥å®šä½åˆ°å•†å“å…ƒç´ çš„ä½ç½®ï¼š
![](https://assets.beyh.net/20200605-4.avif)

# æ•°æ®åº“

çˆ¬å–çš„ä¿¡æ¯é€‰æ‹©å­˜å‚¨åˆ°æœ¬åœ°çš„MySQLæ•°æ®åº“ä¸­ï¼Œæ–°å»ºæ•°æ®åº“åŒ…å«çš„åˆ—æœ‰ï¼šçˆ¬å–å•†å“çš„åºå·ï¼Œæ‰‹æœºçš„åç§°ï¼Œæ‰‹æœºçš„ä»·æ ¼ï¼Œæ‰‹æœºçš„è¯„ä»·æ•°ï¼ˆé”€é‡ï¼‰,é”€å”®æ‰‹æœºçš„å•†å®¶ï¼Œæ‰‹æœºçš„é“¾æ¥ã€‚
å…¶ä¸­ï¼Œåºå·ä¸ºè¡¨çš„ä¸»é”®ï¼Œä»·æ ¼å’Œè¯„ä»·æ•°é€‰æ‹©ä½¿ç”¨INTç±»å‹å­˜å‚¨ï¼Œå…¶ä»–å‡é‡‡ç”¨VARCHARç±»å‹å­˜å‚¨ã€‚
æ•°æ®åº“çš„ç»“æ„å¦‚ä¸‹å›¾ï¼š
![](https://assets.beyh.net/20200605-5.avif)

# ç¼–å†™ä»£ç 

æ¥ä¸‹æ¥å°±å¯ä»¥ç¼–å†™ä»£ç ï¼Œä¸»è¦é€šè¿‡pythonä¸‹çš„seleniumåº“æ¥å¯¹ç½‘é¡µè¿›è¡Œçˆ¬å–ï¼Œå…¶ä¸­ä»£ç å¦‚ä¸‹ï¼š

```python
    from selenium import webdriver
    from selenium.common.exceptions import TimeoutException
    from selenium.webdriver.common.by import By
    from selenium.webdriver.support import expected_conditions as EC
    from selenium.webdriver.support.wait import WebDriverWait
    from multiprocessing.pool import Pool
    from urllib.parse import quote
    from pyquery import PyQuery as pq
    import time
    import pymysql
    import cryptography
    
    a=1
    options = webdriver.ChromeOptions()
    options.add_argument('--headless')
    browser = webdriver.Chrome(chrome_options=options)
    wait = WebDriverWait(browser,10)
    KEYWORD = 'æ‰‹æœº'#æœç´¢çš„å…³é”®å­—æ˜¯æ‰‹æœº
    
    headers = {
        'User-Agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36',
        'x-requested-with':'XMLHttpRequest'#ç”¨äºç¿»é¡µ
    }
    
    def index_page(page):
    
        print('æ­£åœ¨çˆ¬å–ç¬¬', page, 'é¡µ')
        try:
            url = 'https://search.jd.com/Search?keyword={}&enc=utf-8&page={}'.format(quote(KEYWORD),page*2-1)
            print(url)
            browser.get(url)
            time.sleep(0.5)
            return browser.page_source
            # browser.close()
        except TimeoutException:
            index_page(page)
    
    def connect_mysql(sql):#å†™å…¥åˆ°MySQLæ•°æ®åº“
    
        coon = pymysql.connect(host='localhost',port=3306,user='root',passwd ='123456',db ='phone',charset ='utf8')
        cur = coon.cursor()
        cur.execute(sql)
        if sql.strip()[:6].upper() == 'SELECT':
        res = cur.fetchall()
        else:
        coon.commit()
        res = 'ok'
        cur.close()
        coon.close()
    
        return res
    
    def get_products(html):
        global a
        # html = browser.page_source
        doc = pq(html)
        items = doc('#J_goodsList > ul > li').items()#å…¨éƒ¨ä¿¡æ¯éƒ½åœ¨ulä¸‹çš„liä¸­
        
        for item in items:
            product = {
                'ä»·æ ¼': item.find('div > div.p-price > strong > i').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-price > strong > i
                'è¯„ä»·æ•°': item.find('div > div.p-commit > strong > a').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-commit > strong > a
                'å•†å®¶': item.find('div.p-shop > span > a').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-shop > span > a
                'æ‰‹æœºåç§°': item.find('div > div.p-name.p-name-type-2 > a > em').text(),#J_goodsList > ul > li:nth-child(1) > div > div.p-name.p-name-type-2 > a > em
                'é“¾æ¥': item.find('div > div.p-img > a').attr('href'),#J_goodsList > ul > li:nth-child(1) > div > div.p-img > a
            }
            price=product['ä»·æ ¼']
            phone=product['æ‰‹æœºåç§°']
            mark=product['è¯„ä»·æ•°']
            seller=product['å•†å®¶']
            link=product['é“¾æ¥']
    
            if price.isdigit():
                continue#å¦‚æœä»·æ ¼ä¸æ˜¯æ•°å­—ï¼Œè·³è¿‡æœ¬æ¬¡å¾ªç¯
            mark=mark.replace('+','')#å•ä½æ ‡å‡†åŒ–
            if 'ä¸‡' in mark:
                mark=mark.replace('ä¸‡','')#å•ä½æ ‡å‡†åŒ–
                mark=float(mark)
                mark=mark*10000
            else:
                mark=float(mark)
            
            print(product)
            sql="INSERT INTO `phone`.`phone_list` (`åºå·`,`æ‰‹æœºåç§°`, `ä»·æ ¼`, `è¯„ä»·æ•°(é”€é‡)`, `å•†å®¶`, `é“¾æ¥`) VALUES ('"+str(a)+"', '"+phone+"', '"+price+"','"+str(mark)+"','"+seller+"','"+link+"');"
            connect_mysql(sql)
            a+=1
            
    if __name__ == '__main__':
        for i in range(1,101):#å¾ªç¯100æ¬¡
            get_products(index_page(i))
```

# ç»“æœ

æœ€åä¸€å…±çˆ¬å–åˆ°äº†3000ä¸ªå•†å“ï¼Œå­˜å‚¨åˆ°æ•°æ®åº“åçš„æ•ˆæœå¦‚ä¸‹ï¼š
![](https://assets.beyh.net/20200605-6.avif)
æ•°æ®é‡‡é›†çš„ä»»åŠ¡å®Œæˆã€‚

- è¯·æ³¨æ„ï¼Œæœ¬å·¥ä½œå®Œæˆæ—¶é—´ä¸ºï¼š2019-12-11ï¼Œç›¸åº”çš„æ•°æ®å¯èƒ½ä¸ç°åœ¨ä¸åŒï¼Œéœ€æ³¨æ„æ—¶æ•ˆæ€§ã€‚